<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>

  <script>
     document.getElementById('add').addEventListener('click',add)

  //คำสั่งเพิ่มข้อมูล
      function add(){
        event.preventDefault()
       $('#add2').show()
       $('#add').hide()
        if(document.getElementById('input1').value == "" 
        || document.getElementById('input2').value == "" 
        || document.getElementById('input3').value == "" 
        || document.getElementById('input4').value == "" 
        || document.getElementById('input5').value == "" 
        || document.getElementById('input6').value == ""
        || document.getElementById('input7').value == ""
        || document.getElementById('input8').value == ""
        || document.getElementById('input9').value == ""
        || document.getElementById('input10').value == ""
        || document.getElementById('input11').value == ""
        || document.getElementById('input12').value == ""
        || document.getElementById('input13').value == ""
        || document.getElementById('input14').value == ""
        || document.getElementById('input15').value == ""
        || document.getElementById('input16').value == ""
        || document.getElementById('input17').value == ""
        || document.getElementById('input18').value == ""
        || document.getElementById('input19').value == ""
        || document.getElementById('input20').value == ""
        || document.getElementById('input21').value == ""
        || document.getElementById('input22').value == ""
        || document.getElementById('input23').value == ""
        || document.getElementById('input24').value == ""
        || document.getElementById('input25').value == ""
        || document.getElementById('input26').value == ""
        || document.getElementById('input27').value == ""
        || document.getElementById('input28').value == ""
        || document.getElementById('input29').value == ""
        || document.getElementById('input30').value == ""
        

        || document.getElementById('input31').checked  == false){
        //$('#btncondition').click()
           document.getElementById("output").innerHTML = "<div class='alert alert-danger' role='alert'>กรอกข้อมูลไม่ครบ!</div>";
          setTimeout(function(){
          document.getElementById('output').innerHTML= ""; }, 1500);  
         $('#add2').hide()
         $('#add').show()
           }else{
      var obj = {}
       obj.input1 = document.getElementById('input1').value 
       obj.input2 = document.getElementById('input2').value 
       obj.input3 = document.getElementById('input3').value
       obj.input4 = document.getElementById('input4').value
       obj.input5 = document.getElementById('input5').value
       obj.input6 = document.getElementById('input6').value  
       obj.input7 = document.getElementById('input7').value  
       obj.input8 = document.getElementById('input8').value  
       obj.input9 = document.getElementById('input9').value
       obj.input10 = document.getElementById('input10').value              
       obj.input11 = document.getElementById('input11').value 
       obj.input12 = document.getElementById('input12').value 
       obj.input13 = document.getElementById('input13').value 
       obj.input14 = document.getElementById('input14').value 
       obj.input15 = document.getElementById('input15').value 
       obj.input16 = document.getElementById('input16').value 
       obj.input17 = document.getElementById('input17').value 
       obj.input18 = document.getElementById('input18').value 
       obj.input19 = document.getElementById('input19').value 
       obj.input20 = document.getElementById('input20').value 
       obj.input21 = document.getElementById('input21').value 
       obj.input22 = document.getElementById('input22').value 
       obj.input23 = document.getElementById('input23').value 
       obj.input24 = document.getElementById('input24').value 
       obj.input25 = document.getElementById('input25').value 
       obj.input26 = document.getElementById('input26').value 
       obj.input27 = document.getElementById('input27').value 
       obj.input28 = document.getElementById('input28').value 
       obj.input29 = document.getElementById('input29').value 
       obj.input30 = document.getElementById('input30').value 
       google.script.run.withSuccessHandler(addSuccess).addRecord(obj)
        }  
      }
      function addSuccess(output){
       if(output.result == true){
          document.getElementById('myForm').reset() 
          document.getElementById("output").innerHTML = "<div class='alert alert-primary' role='alert'>ลงทะเบียนสำเร็จ</div>";
           $('#add2').hide()
           $('#add').show()
            $('#modal').click()
             setTimeout(function(){
            document.getElementById('output').innerHTML= ""; }, 2000);  

          //แสดงตาราง
        var div =  document.createElement('div')
            div.setAttribute('id','tb')
            document.body.appendChild(div)
            document.getElementById('tb').innerHTML = 
          
           `<tr>                              
            <th scope='col'>ชื่อ-สกุล</th>
            <td scope='col'>${output.data[0]}</td>
            </tr>
            <tr>
            <th scope='col'>ชื่อ-สกุล</th>            
            <td scope='col'>${output.data[3]}</td>
            </tr>
            <tr>                              
            <th scope='col'>ชื่อ-สกุล</th>
            <td scope='col'>${output.data[6]}</td>
            </tr>
            <tr>
            <th scope='col'>ชื่อ-สกุล</th>            
            <td scope='col'>${output.data[9]}</td>
            <tr/>
            <tr>                              
            <th scope='col'>ชื่อ-สกุล</th>
            <td scope='col'>${output.data[12]}</td>
            </tr>
            <tr>                              
            <th scope='col'>ระดับชั้น</th>
            <td scope='col'>${output.data[16]}</td>
            </tr>
            <tr>
            <th scope='col'>ชื่อทีม</th>            
            <td scope='col'>${output.data[15]}</td>   
            </tr> 
            <tr> 
            <th scope='col'>อีเมล</th>            
            <td scope='col'>${output.data[18]}</td> 
            </tr>
            <tr> 
            <th scope='col'>รหัสผ่าน</th>            
            <td colspan='3'>${output.data[19]}</td>           
            </tr>
            <tr>
            <th scope='col'>ระดับชั้น(คนละห้อง)</th>            
            <td scope='col'>${output.data[17]}</td>           
            </tr>`
            
       }else{
          document.getElementById("output").innerHTML = "<div class='alert alert-danger' role='alert'>อีเมลนี้ ลงทะเบียนแล้ว</div>";
           $('#add2').hide()
           $('#add').show()
            setTimeout(function(){
            document.getElementById('output').innerHTML= "";}, 3000);  
       }
      }

  </script>
